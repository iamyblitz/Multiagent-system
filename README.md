# Мультиагентная система: Local Voting Protocol (LVP)

Распределенная система для достижения консенсуса (вычисления среднего значения) между агентами с использованием протокола локального голосования.

## Описание алгоритма

### Математическая модель

Local Voting Protocol — это итеративный алгоритм консенсуса, где каждый агент обновляет свое значение на основе информации от соседей:

$$x_i(t+1) = x_i(t) + \gamma \sum_{j \in N_i} (x_j(t) - x_i(t))$$

Где:
- $x_i(t)$ — значение агента $i$ на итерации $t$
- $N_i$ — множество соседей агента $i$ в графе коммуникаций
- $\gamma$ — шаг сходимости (learning rate)

### Свойства

- **Децентрализация**: нет центрального узла
- **Асимптотическая сходимость**: $\lim_{t \to \infty} x_i(t) = \bar{x}$, где $\bar{x}$ — среднее начальных значений
- **Робастность**: устойчивость к отказам отдельных агентов

## Параметры конфигурации

| Параметр | Значение | Описание |
|----------|----------|----------|
| `GAMMA` | 0.1 | Шаг сходимости. Меньше → медленнее, но стабильнее |
| `EPSILON` | 0.001 | Порог изменения для определения локальной сходимости |
| `MAX_ITERATIONS` | 50 | Максимальное число итераций |
| `CONVERGENCE_PATIENCE` | 5 | Сколько итераций без изменений = сходимость |

### Стоимость операций

| Операция | Стоимость |
|----------|-----------|
| Отправка/прием сообщения | 0.1 |
| Арифметическая операция | 0.01 |
| Хранение числа в памяти | 0.1 |

## Структура проекта

```
Homework1/
├── agent.py          # LVPAgent с логикой консенсуса
├── main.py           # Точка входа, создание системы
├── graph_utils.py    # Генерация случайного графа
├── config.py         # Параметры и константы
└── README.md         # Документация
```

## Запуск

### Требования

- Python 3.8+
- SPADE framework
- XMPP сервер (встроенный в SPADE)

### Установка

```bash
source venv/bin/activate
pip install spade
```

### Запуск системы

```bash
python3 main.py
```

## Пример вывода

```
============================================================
МУЛЬТИАГЕНТНАЯ СИСТЕМА С LVP (Local Voting Protocol)
============================================================
Числа агентов: [95, 46, 42, 21, 80, 93, 19, 21, 11, 55, 90, 3, 81, 96, 57]
Ожидаемое среднее: 54.0000

Граф коммуникаций (соседи):
  Agent0: [1, 6]
  Agent1: [0, 2, 4, 13, 3]
  ...

============================================================
ЗАПУСК АГЕНТОВ
============================================================
[Agent0] Запущен LVP с числом 95.0
...
[Agent5] Сошелся на итерации 23. Значение: 54.0123

============================================================
РЕЗУЛЬТАТЫ LVP
============================================================
Agent 0: Val= 54.0234 Err=0.0234 Cost= 12.45 Iters=30 [✓]
Agent 1: Val= 53.9876 Err=0.0124 Cost= 15.23 Iters=35 [✓]
...

============================================================
СТАТИСТИКА
============================================================
Среднее по агентам:     54.0045
Ожидаемое среднее:      54.0000
Максимальная ошибка:    0.0234
Сошлось агентов:        15/15
ОБЩАЯ СТОИМОСТЬ:        187.65
============================================================
```

## Сравнение с централизованным подходом

| Подход | Сообщений | Стоимость | Надежность |
|--------|-----------|-----------|------------|
| Централизованный | 15 | ~15,000 | Низкая (единая точка отказа) |
| LVP (дерево) | ~30 | ~10 | Средняя |
| LVP (случайный граф) | ~200-500 | ~150-300 | Высокая |

## Оптимизации

### Реализованные

- ✅ Нормализация JID для O(1) поиска соседей
- ✅ Досрочное завершение при сходимости
- ✅ Адаптивное логирование (каждые 10 итераций)

### Возможные улучшения

- Адаптивный GAMMA (уменьшение со временем)
- Обнаружение глобальной сходимости
- Визуализация процесса сходимости
